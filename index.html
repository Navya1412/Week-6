<!DOCTYPE html>
<html>
    <head>
        <title> Weather </title>
        <style></style>
    </head>
    <body>
        <div id="weather-info">

        </div>

        <script>
            function getLocation() {
                console.log('getting location');

                if(navigator.geoloction) {
                    navigatior.geoloaction.getCurrentPosition(getWeather);
                    } else {
                        const weatherInfo = document.getElementById('weather-info');
                        weatherInfo.innerHTML = '<p> Geolocation is not supported </p>';
                    }
            };

            async function getWeather (position) {
                console.log(position);
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                // const apiKey = '2c61b92b2e57a0cb95ba76b2a9eb9fd6';

                const apiKey = '8c27e7fb4cb24063af105842230509';

                const locStr = latitude + ',' + longitude;
                console.log(locStr);

                try {
                    const response = await fetch('http://api.weatherapi.com/v1/current.json?key='+apiKey+'&q='+locStr+'&aqi=no');
                    const data = await response.json();
                    console.log(data);

                    const weatherInfo = document.getElementById('weather-info');

					const currentLocation = "<h2>" + data.location.name + "</h2>";
					const currentTemp = "<p>" + data.current.temp_c + "</p>";

					weatherInfo.innerHTML = currentLocation + currentTemp;
                
                } catch(error) {
                    console.log('Error',error);
                }
            };

            getLocation();

        </script>
    </body>
</html>